<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Home</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="app-bar">
    <div class="nav">
      <a href="homepage.html">Home</a>
      <a href="games.html">Games</a>
      <a href="settings.html">Settings</a>
      <a href="proxy.html" class="active">Proxy</a>
       <a href="chat.html">Chat</a>
      <a href="media.html">Media</a>
    </div>
    <div class="profile-trigger" onclick="location.href='profile.html'" style="cursor:pointer; margin-right: 20px;">
        <div id="userProfilePic" class="pfp-small" style="width:32px; height:32px; border-radius:50%; border:1px solid var(--accent); background-size:cover; background-color:#000;"></div>
    </div>
  </div>

  <div class="container">
    <iframe class="fade-up" src="https://minnit.chat/"></iframe>
  </div>

  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js"></script>

  <script>
const firebaseConfig = {
    apiKey: "AIzaSyAgsZ68VNL-b5AsWnzll2g_C1Yhw7IowlY",
    authDomain: "gameparadiserawdata.firebaseapp.com",
    projectId: "gameparadiserawdata",
    appId: "1:6326540558:web:8115f5520f0737b239df5f"
};
const isIncognito = new URLSearchParams(window.location.search).get('incognito') === '1';

if (!isIncognito) {
    firebase.initializeApp(firebaseConfig);
}
const auth = isIncognito ? null : firebase.auth();
const db = isIncognito ? null : firebase.firestore();
// Preserve incognito mode across page navigation
if (isIncognito) {
    document.querySelectorAll('.nav a').forEach(link => {
        const url = new URL(link.href);
        url.searchParams.set('incognito', '1');
        link.href = url.toString();
    });
    
    // Also update profile trigger if it exists
    const profileTrigger = document.querySelector('.profile-trigger');
    if (profileTrigger) {
        profileTrigger.onclick = () => location.href = 'profile.html?incognito=1';
    }
}
function loadUserTheme(uid) {
    if (isIncognito) return;
    db.collection("users").doc(uid).collection("settings").doc("appearance").get().then(doc => {
            if (doc.exists) {
                const data = doc.data();
                const root = document.documentElement;
                const presets = {
                    'red': {bg: '#1a0505', surf: '#250a0a', bord: '#451515'},
                    'blue': {bg: '#050a1a', surf: '#0a1425', bord: '#152545'},
                    'green': {bg: '#051a05', surf: '#0a250a', bord: '#154515'},
                    'yellow': {bg: '#1a1a05', surf: '#25250a', bord: '#454515'},
                    'orange': {bg: '#1a1005', surf: '#25150a', bord: '#452515'},
                    'purple': {bg: '#10051a', surf: '#150a25', bord: '#251545'},
                    'pink': {bg: '#1a0510', surf: '#250a15', bord: '#451525'},
                    'black': {bg: '#000000', surf: '#080808', bord: '#111'},
                    'white': {bg: '#f0f0f0', surf: '#ffffff', bord: '#ccc'},
                    'gray': {bg: '#1a1a1a', surf: '#222222', bord: '#333'},
                    'cyberpunk': {bg: '#000000', surf: '#0a0a1a', bord: '#ff0055'},
                    'nordic': {bg: '#2e3440', surf: '#3b4252', bord: '#4c566a'},
                    'amethyst': {bg: '#0f051a', surf: '#180a25', bord: '#351545'},
                    'midnight': {bg: '#020205', surf: '#050510', bord: '#101030'},
                    'matrix': {bg: '#000500', surf: '#001000', bord: '#00ff41'},
                    'oceanic': {bg: '#010b13', surf: '#021627', bord: '#032b4d'},
                    'lava': {bg: '#100000', surf: '#200000', bord: '#ff4500'},
                    'vaporwave': {bg: '#1a0033', surf: '#2d0059', bord: '#ff71ce'},
                    'forest': {bg: '#0a1005', surf: '#15200a', bord: '#2d4d1a'},
                    'space': {bg: '#05000a', surf: '#0b001a', bord: '#4b0082'}
                };
                if (presets[data.themePreset]) {
                    const p = presets[data.themePreset];
                    root.style.setProperty('--bg', p.bg);
                    root.style.setProperty('--surface', p.surf);
                    root.style.setProperty('--border', p.bord);
                }
                if (data.accentColor) root.style.setProperty('--accent', data.accentColor);
                if (data.textColor) root.style.setProperty('--text', data.textColor);
            }
        });
    }

    if (isIncognito) {
    // Skip authentication in incognito mode
} else {
    auth.onAuthStateChanged(user => {
        if (user) {
            loadUserTheme(user.uid);
            db.collection("users").doc(user.uid).get().then(doc => {
                if(doc.exists && doc.data().photoURL) {
                    document.getElementById('userProfilePic').style.backgroundImage = `url('${doc.data().photoURL}')`;
                }
            });
        } else {
            window.location.href = "index.html";
        }
    });
}
  </script>
</body>
</html>